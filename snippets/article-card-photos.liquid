{% comment %}
  Renders an article card for a given blog with settings to either show the image or not.

  Accepts:
  - blog: {Object} Blog object
  - article: {Object} Article object
  - media_aspect_ratio: {String} The setting changes the aspect ratio of the article image, if shown
  - media_height: {String} The setting changes the height of the article image. Overrides media_aspect_ratio.
  - show_image: {String} The setting either show the article image or not. If it's not included it will show the image by default
  - show_date: {String} The setting either show the article date or not. If it's not included it will not show the image by default
  - show_author: {String} The setting either show the article author or not. If it's not included it will not show the author by default
  - show_badge: {String} The setting either show the blog badge or not.
  - lazy_load: {Boolean} Image should be lazy loaded. Default: true (optional)

  Usage:
  {% render 'article-card' blog: blog, article: article, show_image: section.settings.show_image %}
{% endcomment %}

{%- if article and article != empty -%}
  {%- liquid
    assign ratio = 1
    if media_aspect_ratio != null
      assign ratio = media_aspect_ratio
    endif
  -%}

  <div class="rounded-2xl hover:bg-white/5 transition-colors overflow-hidden w-full">
    {% comment %} <article aria-labelledby="Article-{{ article.id }}"> {% endcomment %}
    <a href="{{ article.url }}" class="hover:text-white transition-colors w-full">
      <div class="">
        {%- if show_image == true and article.image -%}
          <div class="w-full h-[200px] overflow-hidden">
            <img
              src="{{ article.image.src | image_url: width: 1200 }}"
              sizes="(min-width: 1024px) 300px, (min-width: 768px) 50vw, 100vw"
              alt="{{ article.image.src.alt | escape }}"
              class="w-full h-full object-cover object-center rounded-lg"
              {% unless lazy_load == false %}
              loading="lazy"
              {% endunless %}
              width="{{ article.image.width }}"
              height="{{ article.image.height }}">
          </div>
        {%- else -%}
          <div class="w-full h-full min-h-[200px] rounded-lg p-8 flex flex-col justify-center items-center" style="background-color: {{ article.metafields.custom.background_color.value | default: '#2A2A2A' }}">
            <div class="space-y-3 text-center">
              <h3 class="porter-sans text-black text-5xl md:text-4xl md:text-6xl font-normal leading-tight tracking-tight">
                {{ article.title | truncate: 50 | escape }}
              </h3>

              {%- if show_excerpt -%}
                {%- if article.excerpt.size > 0 or article.content.size > 0 -%}
                  <p class="text-white text-lg md:text-xl leading-relaxed mb-4">
                    {%- if article.excerpt.size > 0 -%}
                      {{ article.excerpt | strip_html | truncatewords: 15 }}
                    {%- else -%}
                      {{ article.content | strip_html | truncatewords: 15 }}
                    {%- endif -%}
                  </p>
                {%- endif -%}
              {%- endif -%}

              <div class="flex items-center justify-center space-x-3 text-sm text-gray-300">
                {%- if show_date -%}
                  <span class="opacity-70 text-2xl md:text-3xl border border-black text-black px-7 pt-1 rounded-full">{{ article.published_at | date: '%Y' }}</span>
                {%- endif -%}
                {%- if show_author and show_date -%}
                  <span class="w-1 h-1 bg-gray-400 rounded-full"></span>
                {%- endif -%}
                {%- if show_author -%}
                  <span class="opacity-70">{{ article.author }}</span>
                {%- endif -%}
              </div>
            </div>
          </div>
        {%- endif -%}

        {%- if show_badge -%}
          <div class="absolute top-4 left-4">
            <span class="px-2 py-1 text-xs font-medium bg-white/10 text-white rounded-full">{{ 'blogs.article.blog' | t }}</span>
          </div>
        {%- endif -%}
      </div>
    </a>
  </div>
{%- endif -%}